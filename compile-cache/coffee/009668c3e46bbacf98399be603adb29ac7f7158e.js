(function() {
  var Conflict, util;

  Conflict = require('../lib/conflict').Conflict;

  util = require('./util');

  describe("Conflict", function() {
    describe('a single two-way diff', function() {
      var conflict;
      conflict = [][0];
      beforeEach(function() {
        return util.openPath('single-2way-diff.txt', function(editorView) {
          return conflict = Conflict.all({
            isRebase: false
          }, editorView.getModel())[0];
        });
      });
      it('identifies the correct rows', function() {
        expect(util.rowRangeFrom(conflict.ours.marker)).toEqual([1, 2]);
        expect(conflict.ours.ref).toBe('HEAD');
        expect(util.rowRangeFrom(conflict.theirs.marker)).toEqual([3, 4]);
        return expect(conflict.theirs.ref).toBe('master');
      });
      it('finds the ref banners', function() {
        expect(util.rowRangeFrom(conflict.ours.refBannerMarker)).toEqual([0, 1]);
        return expect(util.rowRangeFrom(conflict.theirs.refBannerMarker)).toEqual([4, 5]);
      });
      it('finds the separator', function() {
        return expect(util.rowRangeFrom(conflict.navigator.separatorMarker)).toEqual([2, 3]);
      });
      it('marks "ours" as the top and "theirs" as the bottom', function() {
        expect(conflict.ours.position).toBe('top');
        return expect(conflict.theirs.position).toBe('bottom');
      });
      it('links each side to the following marker', function() {
        expect(conflict.ours.followingMarker).toBe(conflict.navigator.separatorMarker);
        return expect(conflict.theirs.followingMarker).toBe(conflict.theirs.refBannerMarker);
      });
      return it('does not have base side', function() {
        return expect(conflict.base).toBeNull();
      });
    });
    describe('a single three-way diff', function() {
      var conflict;
      conflict = [][0];
      beforeEach(function() {
        return util.openPath('single-3way-diff.txt', function(editorView) {
          return conflict = Conflict.all({
            isRebase: false
          }, editorView.getModel())[0];
        });
      });
      it('identifies the correct rows', function() {
        expect(util.rowRangeFrom(conflict.ours.marker)).toEqual([1, 2]);
        expect(conflict.ours.ref).toBe('HEAD');
        expect(util.rowRangeFrom(conflict.base.marker)).toEqual([3, 4]);
        expect(conflict.base.ref).toBe('merged common ancestors');
        expect(util.rowRangeFrom(conflict.theirs.marker)).toEqual([5, 6]);
        return expect(conflict.theirs.ref).toBe('master');
      });
      it('finds the ref banners', function() {
        expect(util.rowRangeFrom(conflict.ours.refBannerMarker)).toEqual([0, 1]);
        expect(util.rowRangeFrom(conflict.base.refBannerMarker)).toEqual([2, 3]);
        return expect(util.rowRangeFrom(conflict.theirs.refBannerMarker)).toEqual([6, 7]);
      });
      it('finds the separator', function() {
        return expect(util.rowRangeFrom(conflict.navigator.separatorMarker)).toEqual([4, 5]);
      });
      it('marks "ours" as the top and "theirs" as the bottom', function() {
        expect(conflict.ours.position).toBe('top');
        expect(conflict.base.position).toBe('base');
        return expect(conflict.theirs.position).toBe('bottom');
      });
      return it('links each side to the following marker', function() {
        expect(conflict.ours.followingMarker).toBe(conflict.base.refBannerMarker);
        expect(conflict.base.followingMarker).toBe(conflict.navigator.separatorMarker);
        return expect(conflict.theirs.followingMarker).toBe(conflict.theirs.refBannerMarker);
      });
    });
    it("identifies the correct rows for complex three-way diff", function() {
      return util.openPath('single-3way-diff-complex.txt', function(editorView) {
        var conflict;
        conflict = Conflict.all({
          isRebase: false
        }, editorView.getModel())[0];
        expect(util.rowRangeFrom(conflict.ours.marker)).toEqual([1, 2]);
        expect(conflict.ours.ref).toBe('HEAD');
        expect(util.rowRangeFrom(conflict.base.marker)).toEqual([3, 18]);
        expect(conflict.base.ref).toBe('merged common ancestors');
        expect(util.rowRangeFrom(conflict.theirs.marker)).toEqual([19, 20]);
        return expect(conflict.theirs.ref).toBe('master');
      });
    });
    it("finds multiple conflict markings", function() {
      return util.openPath('multi-2way-diff.txt', function(editorView) {
        var cs;
        cs = Conflict.all({}, editorView.getModel());
        expect(cs.length).toBe(2);
        expect(util.rowRangeFrom(cs[0].ours.marker)).toEqual([5, 7]);
        expect(util.rowRangeFrom(cs[0].theirs.marker)).toEqual([8, 9]);
        expect(util.rowRangeFrom(cs[1].ours.marker)).toEqual([14, 15]);
        return expect(util.rowRangeFrom(cs[1].theirs.marker)).toEqual([16, 17]);
      });
    });
    describe('with corrupted diffs', function() {
      it('handles corrupted diff output', function() {
        return util.openPath('corrupted-2way-diff.txt', function(editorView) {
          var cs;
          cs = Conflict.all({}, editorView.getModel());
          return expect(cs.length).toBe(0);
        });
      });
      return it('handles corrupted diff3 output', function() {
        return util.openPath('corrupted-3way-diff.txt', function(editorView) {
          var cs;
          cs = Conflict.all({}, editorView.getModel());
          expect(cs.length).toBe(1);
          expect(util.rowRangeFrom(cs[0].ours.marker)).toEqual([13, 14]);
          expect(util.rowRangeFrom(cs[0].base.marker)).toEqual([15, 16]);
          return expect(util.rowRangeFrom(cs[0].theirs.marker)).toEqual([17, 18]);
        });
      });
    });
    describe('when rebasing', function() {
      var conflict;
      conflict = [][0];
      beforeEach(function() {
        return util.openPath('rebase-2way-diff.txt', function(editorView) {
          return conflict = Conflict.all({
            isRebase: true
          }, editorView.getModel())[0];
        });
      });
      it('swaps the lines for "ours" and "theirs"', function() {
        expect(util.rowRangeFrom(conflict.theirs.marker)).toEqual([3, 4]);
        return expect(util.rowRangeFrom(conflict.ours.marker)).toEqual([5, 6]);
      });
      it('recognizes banner lines with commit shortlog messages', function() {
        expect(util.rowRangeFrom(conflict.theirs.refBannerMarker)).toEqual([2, 3]);
        return expect(util.rowRangeFrom(conflict.ours.refBannerMarker)).toEqual([6, 7]);
      });
      it('marks "theirs" as the top and "ours" as the bottom', function() {
        expect(conflict.theirs.position).toBe('top');
        return expect(conflict.ours.position).toBe('bottom');
      });
      return it('links each side to the following marker', function() {
        expect(conflict.theirs.followingMarker).toBe(conflict.navigator.separatorMarker);
        return expect(conflict.ours.followingMarker).toBe(conflict.ours.refBannerMarker);
      });
    });
    describe('sides', function() {
      var conflict, editor, ref;
      ref = [], editor = ref[0], conflict = ref[1];
      beforeEach(function() {
        return util.openPath('single-2way-diff.txt', function(editorView) {
          var ref1;
          editor = editorView.getModel();
          return ref1 = Conflict.all({}, editor), conflict = ref1[0], ref1;
        });
      });
      it('retains a reference to conflict', function() {
        expect(conflict.ours.conflict).toBe(conflict);
        return expect(conflict.theirs.conflict).toBe(conflict);
      });
      it('remembers its initial text', function() {
        editor.setCursorBufferPosition([1, 0]);
        editor.insertText("I prefer this text! ");
        return expect(conflict.ours.originalText).toBe("These are my changes\n");
      });
      it('resolves as "ours"', function() {
        conflict.ours.resolve();
        expect(conflict.resolution).toBe(conflict.ours);
        expect(conflict.ours.wasChosen()).toBe(true);
        return expect(conflict.theirs.wasChosen()).toBe(false);
      });
      it('resolves as "theirs"', function() {
        conflict.theirs.resolve();
        expect(conflict.resolution).toBe(conflict.theirs);
        expect(conflict.ours.wasChosen()).toBe(false);
        return expect(conflict.theirs.wasChosen()).toBe(true);
      });
      return it('broadcasts an event on resolution', function() {
        var resolved;
        resolved = false;
        conflict.onDidResolveConflict(function() {
          return resolved = true;
        });
        conflict.ours.resolve();
        return expect(resolved).toBe(true);
      });
    });
    return describe('navigator', function() {
      var conflicts, navigator, ref;
      ref = [], conflicts = ref[0], navigator = ref[1];
      beforeEach(function() {
        return util.openPath('triple-2way-diff.txt', function(editorView) {
          conflicts = Conflict.all({}, editorView.getModel());
          return navigator = conflicts[1].navigator;
        });
      });
      it('knows its conflict', function() {
        return expect(navigator.conflict).toBe(conflicts[1]);
      });
      it('links to the previous conflict', function() {
        return expect(navigator.previous).toBe(conflicts[0]);
      });
      it('links to the next conflict', function() {
        return expect(navigator.next).toBe(conflicts[2]);
      });
      it('skips resolved conflicts', function() {
        var nav;
        nav = conflicts[0].navigator;
        conflicts[1].ours.resolve();
        return expect(nav.nextUnresolved()).toBe(conflicts[2]);
      });
      return it('returns null at the end', function() {
        var nav;
        nav = conflicts[2].navigator;
        expect(nav.next).toBeNull();
        return expect(nav.nextUnresolved()).toBeNull();
      });
    });
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiL1VzZXJzL2xyYW1pcmV6Ly5hdG9tL3BhY2thZ2VzL21lcmdlLWNvbmZsaWN0cy9zcGVjL2NvbmZsaWN0LXNwZWMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUEsTUFBQTs7RUFBQyxXQUFZLE9BQUEsQ0FBUSxpQkFBUjs7RUFDYixJQUFBLEdBQU8sT0FBQSxDQUFRLFFBQVI7O0VBRVAsUUFBQSxDQUFTLFVBQVQsRUFBcUIsU0FBQTtJQUVuQixRQUFBLENBQVMsdUJBQVQsRUFBa0MsU0FBQTtBQUNoQyxVQUFBO01BQUMsV0FBWTtNQUViLFVBQUEsQ0FBVyxTQUFBO2VBQ1QsSUFBSSxDQUFDLFFBQUwsQ0FBYyxzQkFBZCxFQUFzQyxTQUFDLFVBQUQ7aUJBQ3BDLFFBQUEsR0FBVyxRQUFRLENBQUMsR0FBVCxDQUFhO1lBQUUsUUFBQSxFQUFVLEtBQVo7V0FBYixFQUFrQyxVQUFVLENBQUMsUUFBWCxDQUFBLENBQWxDLENBQXlELENBQUEsQ0FBQTtRQURoQyxDQUF0QztNQURTLENBQVg7TUFJQSxFQUFBLENBQUcsNkJBQUgsRUFBa0MsU0FBQTtRQUNoQyxNQUFBLENBQU8sSUFBSSxDQUFDLFlBQUwsQ0FBa0IsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFoQyxDQUFQLENBQThDLENBQUMsT0FBL0MsQ0FBdUQsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUF2RDtRQUNBLE1BQUEsQ0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQXJCLENBQXlCLENBQUMsSUFBMUIsQ0FBK0IsTUFBL0I7UUFDQSxNQUFBLENBQU8sSUFBSSxDQUFDLFlBQUwsQ0FBa0IsUUFBUSxDQUFDLE1BQU0sQ0FBQyxNQUFsQyxDQUFQLENBQWdELENBQUMsT0FBakQsQ0FBeUQsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUF6RDtlQUNBLE1BQUEsQ0FBTyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQXZCLENBQTJCLENBQUMsSUFBNUIs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LGNBQUosQ0FBQSxDQUFQLENBQTRCLENBQUMsSUFBN0IsQ0FBa0MsU0FBVSxDQUFBLENBQUEsQ0FBNUM7TUFINkIsQ0FBL0I7YUFLQSxFQUFBLENBQUcseUJBQUgsRUFBOEIsU0FBQTtBQUM1QixZQUFBO1FBQUEsR0FBQSxHQUFNLFNBQVUsQ0FBQSxDQUFBLENBQUUsQ0FBQztRQUNuQixNQUFBLENBQU8sR0FBRyxDQUFDLElBQVgsQ0FBZ0IsQ0FBQyxRQUFqQixDQUFBO2VBQ0EsTUFBQSxDQUFPLEdBQUcsQ0FBQyxjQUFKLENBQUEsQ0FBUCxDQUE0QixDQUFDLFFBQTdCLENBQUE7TUFINEIsQ0FBOUI7SUF0Qm9CLENBQXRCO0VBbkttQixDQUFyQjtBQUhBIiwic291cmNlc0NvbnRlbnQiOlsie0NvbmZsaWN0fSA9IHJlcXVpcmUgJy4uL2xpYi9jb25mbGljdCdcbnV0aWwgPSByZXF1aXJlICcuL3V0aWwnXG5cbmRlc2NyaWJlIFwiQ29uZmxpY3RcIiwgLT5cblxuICBkZXNjcmliZSAnYSBzaW5nbGUgdHdvLXdheSBkaWZmJywgLT5cbiAgICBbY29uZmxpY3RdID0gW11cblxuICAgIGJlZm9yZUVhY2ggLT5cbiAgICAgIHV0aWwub3BlblBhdGggJ3NpbmdsZS0yd2F5LWRpZmYudHh0JywgKGVkaXRvclZpZXcpIC0+XG4gICAgICAgIGNvbmZsaWN0ID0gQ29uZmxpY3QuYWxsKHsgaXNSZWJhc2U6IGZhbHNlIH0sIGVkaXRvclZpZXcuZ2V0TW9kZWwoKSlbMF1cblxuICAgIGl0ICdpZGVudGlmaWVzIHRoZSBjb3JyZWN0IHJvd3MnLCAtPlxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNvbmZsaWN0Lm91cnMubWFya2VyKS50b0VxdWFsKFsxLCAyXSlcbiAgICAgIGV4cGVjdChjb25mbGljdC5vdXJzLnJlZikudG9CZSgnSEVBRCcpXG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3QudGhlaXJzLm1hcmtlcikudG9FcXVhbChbMywgNF0pXG4gICAgICBleHBlY3QoY29uZmxpY3QudGhlaXJzLnJlZikudG9CZSgnbWFzdGVyJylcblxuICAgIGl0ICdmaW5kcyB0aGUgcmVmIGJhbm5lcnMnLCAtPlxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNvbmZsaWN0Lm91cnMucmVmQmFubmVyTWFya2VyKS50b0VxdWFsKFswLCAxXSlcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC50aGVpcnMucmVmQmFubmVyTWFya2VyKS50b0VxdWFsKFs0LCA1XSlcblxuICAgIGl0ICdmaW5kcyB0aGUgc2VwYXJhdG9yJywgLT5cbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC5uYXZpZ2F0b3Iuc2VwYXJhdG9yTWFya2VyKS50b0VxdWFsKFsyLCAzXSlcblxuICAgIGl0ICdtYXJrcyBcIm91cnNcIiBhcyB0aGUgdG9wIGFuZCBcInRoZWlyc1wiIGFzIHRoZSBib3R0b20nLCAtPlxuICAgICAgZXhwZWN0KGNvbmZsaWN0Lm91cnMucG9zaXRpb24pLnRvQmUoJ3RvcCcpXG4gICAgICBleHBlY3QoY29uZmxpY3QudGhlaXJzLnBvc2l0aW9uKS50b0JlKCdib3R0b20nKVxuXG4gICAgaXQgJ2xpbmtzIGVhY2ggc2lkZSB0byB0aGUgZm9sbG93aW5nIG1hcmtlcicsIC0+XG4gICAgICBleHBlY3QoY29uZmxpY3Qub3Vycy5mb2xsb3dpbmdNYXJrZXIpLnRvQmUoY29uZmxpY3QubmF2aWdhdG9yLnNlcGFyYXRvck1hcmtlcilcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMuZm9sbG93aW5nTWFya2VyKS50b0JlKGNvbmZsaWN0LnRoZWlycy5yZWZCYW5uZXJNYXJrZXIpXG5cbiAgICBpdCAnZG9lcyBub3QgaGF2ZSBiYXNlIHNpZGUnLCAtPlxuICAgICAgZXhwZWN0KGNvbmZsaWN0LmJhc2UpLnRvQmVOdWxsKClcblxuICBkZXNjcmliZSAnYSBzaW5nbGUgdGhyZWUtd2F5IGRpZmYnLCAtPlxuICAgIFtjb25mbGljdF0gPSBbXVxuXG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgdXRpbC5vcGVuUGF0aCAnc2luZ2xlLTN3YXktZGlmZi50eHQnLCAoZWRpdG9yVmlldykgLT5cbiAgICAgICAgY29uZmxpY3QgPSBDb25mbGljdC5hbGwoeyBpc1JlYmFzZTogZmFsc2UgfSwgZWRpdG9yVmlldy5nZXRNb2RlbCgpKVswXVxuXG4gICAgaXQgJ2lkZW50aWZpZXMgdGhlIGNvcnJlY3Qgcm93cycsIC0+XG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3Qub3Vycy5tYXJrZXIpLnRvRXF1YWwoWzEsIDJdKVxuICAgICAgZXhwZWN0KGNvbmZsaWN0Lm91cnMucmVmKS50b0JlKCdIRUFEJylcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC5iYXNlLm1hcmtlcikudG9FcXVhbChbMywgNF0pXG4gICAgICBleHBlY3QoY29uZmxpY3QuYmFzZS5yZWYpLnRvQmUoJ21lcmdlZCBjb21tb24gYW5jZXN0b3JzJylcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC50aGVpcnMubWFya2VyKS50b0VxdWFsKFs1LCA2XSlcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMucmVmKS50b0JlKCdtYXN0ZXInKVxuXG4gICAgaXQgJ2ZpbmRzIHRoZSByZWYgYmFubmVycycsIC0+XG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3Qub3Vycy5yZWZCYW5uZXJNYXJrZXIpLnRvRXF1YWwoWzAsIDFdKVxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNvbmZsaWN0LmJhc2UucmVmQmFubmVyTWFya2VyKS50b0VxdWFsKFsyLCAzXSlcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC50aGVpcnMucmVmQmFubmVyTWFya2VyKS50b0VxdWFsKFs2LCA3XSlcblxuICAgIGl0ICdmaW5kcyB0aGUgc2VwYXJhdG9yJywgLT5cbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC5uYXZpZ2F0b3Iuc2VwYXJhdG9yTWFya2VyKS50b0VxdWFsKFs0LCA1XSlcblxuICAgIGl0ICdtYXJrcyBcIm91cnNcIiBhcyB0aGUgdG9wIGFuZCBcInRoZWlyc1wiIGFzIHRoZSBib3R0b20nLCAtPlxuICAgICAgZXhwZWN0KGNvbmZsaWN0Lm91cnMucG9zaXRpb24pLnRvQmUoJ3RvcCcpXG4gICAgICBleHBlY3QoY29uZmxpY3QuYmFzZS5wb3NpdGlvbikudG9CZSgnYmFzZScpXG4gICAgICBleHBlY3QoY29uZmxpY3QudGhlaXJzLnBvc2l0aW9uKS50b0JlKCdib3R0b20nKVxuXG4gICAgaXQgJ2xpbmtzIGVhY2ggc2lkZSB0byB0aGUgZm9sbG93aW5nIG1hcmtlcicsIC0+XG4gICAgICBleHBlY3QoY29uZmxpY3Qub3Vycy5mb2xsb3dpbmdNYXJrZXIpLnRvQmUoY29uZmxpY3QuYmFzZS5yZWZCYW5uZXJNYXJrZXIpXG4gICAgICBleHBlY3QoY29uZmxpY3QuYmFzZS5mb2xsb3dpbmdNYXJrZXIpLnRvQmUoY29uZmxpY3QubmF2aWdhdG9yLnNlcGFyYXRvck1hcmtlcilcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMuZm9sbG93aW5nTWFya2VyKS50b0JlKGNvbmZsaWN0LnRoZWlycy5yZWZCYW5uZXJNYXJrZXIpXG5cbiAgaXQgXCJpZGVudGlmaWVzIHRoZSBjb3JyZWN0IHJvd3MgZm9yIGNvbXBsZXggdGhyZWUtd2F5IGRpZmZcIiwgLT5cbiAgICB1dGlsLm9wZW5QYXRoICdzaW5nbGUtM3dheS1kaWZmLWNvbXBsZXgudHh0JywgKGVkaXRvclZpZXcpIC0+XG4gICAgICBjb25mbGljdCA9IENvbmZsaWN0LmFsbCh7IGlzUmViYXNlOiBmYWxzZSB9LCBlZGl0b3JWaWV3LmdldE1vZGVsKCkpWzBdXG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3Qub3Vycy5tYXJrZXIpLnRvRXF1YWwoWzEsIDJdKVxuICAgICAgZXhwZWN0KGNvbmZsaWN0Lm91cnMucmVmKS50b0JlKCdIRUFEJylcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC5iYXNlLm1hcmtlcikudG9FcXVhbChbMywgMThdKVxuICAgICAgZXhwZWN0KGNvbmZsaWN0LmJhc2UucmVmKS50b0JlKCdtZXJnZWQgY29tbW9uIGFuY2VzdG9ycycpXG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3QudGhlaXJzLm1hcmtlcikudG9FcXVhbChbMTksIDIwXSlcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMucmVmKS50b0JlKCdtYXN0ZXInKVxuXG4gIGl0IFwiZmluZHMgbXVsdGlwbGUgY29uZmxpY3QgbWFya2luZ3NcIiwgLT5cbiAgICB1dGlsLm9wZW5QYXRoICdtdWx0aS0yd2F5LWRpZmYudHh0JywgKGVkaXRvclZpZXcpIC0+XG4gICAgICBjcyA9IENvbmZsaWN0LmFsbCh7fSwgZWRpdG9yVmlldy5nZXRNb2RlbCgpKVxuXG4gICAgICBleHBlY3QoY3MubGVuZ3RoKS50b0JlKDIpXG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY3NbMF0ub3Vycy5tYXJrZXIpLnRvRXF1YWwoWzUsIDddKVxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNzWzBdLnRoZWlycy5tYXJrZXIpLnRvRXF1YWwoWzgsIDldKVxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNzWzFdLm91cnMubWFya2VyKS50b0VxdWFsKFsxNCwgMTVdKVxuICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNzWzFdLnRoZWlycy5tYXJrZXIpLnRvRXF1YWwoWzE2LCAxN10pXG5cbiAgZGVzY3JpYmUgJ3dpdGggY29ycnVwdGVkIGRpZmZzJywgLT5cblxuICAgIGl0ICdoYW5kbGVzIGNvcnJ1cHRlZCBkaWZmIG91dHB1dCcsIC0+XG4gICAgICB1dGlsLm9wZW5QYXRoICdjb3JydXB0ZWQtMndheS1kaWZmLnR4dCcsIChlZGl0b3JWaWV3KSAtPlxuICAgICAgICBjcyA9IENvbmZsaWN0LmFsbCh7fSwgZWRpdG9yVmlldy5nZXRNb2RlbCgpKVxuICAgICAgICBleHBlY3QoY3MubGVuZ3RoKS50b0JlKDApXG5cbiAgICBpdCAnaGFuZGxlcyBjb3JydXB0ZWQgZGlmZjMgb3V0cHV0JywgLT5cbiAgICAgIHV0aWwub3BlblBhdGggJ2NvcnJ1cHRlZC0zd2F5LWRpZmYudHh0JywgKGVkaXRvclZpZXcpIC0+XG4gICAgICAgIGNzID0gQ29uZmxpY3QuYWxsKHt9LCBlZGl0b3JWaWV3LmdldE1vZGVsKCkpXG5cbiAgICAgICAgZXhwZWN0KGNzLmxlbmd0aCkudG9CZSgxKVxuICAgICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY3NbMF0ub3Vycy5tYXJrZXIpLnRvRXF1YWwoWzEzLCAxNF0pXG4gICAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjc1swXS5iYXNlLm1hcmtlcikudG9FcXVhbChbMTUsIDE2XSlcbiAgICAgICAgZXhwZWN0KHV0aWwucm93UmFuZ2VGcm9tIGNzWzBdLnRoZWlycy5tYXJrZXIpLnRvRXF1YWwoWzE3LCAxOF0pXG5cbiAgZGVzY3JpYmUgJ3doZW4gcmViYXNpbmcnLCAtPlxuICAgIFtjb25mbGljdF0gPSBbXVxuXG4gICAgYmVmb3JlRWFjaCAtPlxuICAgICAgdXRpbC5vcGVuUGF0aCAncmViYXNlLTJ3YXktZGlmZi50eHQnLCAoZWRpdG9yVmlldykgLT5cbiAgICAgICAgY29uZmxpY3QgPSBDb25mbGljdC5hbGwoeyBpc1JlYmFzZTogdHJ1ZSB9LCBlZGl0b3JWaWV3LmdldE1vZGVsKCkpWzBdXG5cbiAgICBpdCAnc3dhcHMgdGhlIGxpbmVzIGZvciBcIm91cnNcIiBhbmQgXCJ0aGVpcnNcIicsIC0+XG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3QudGhlaXJzLm1hcmtlcikudG9FcXVhbChbMywgNF0pXG4gICAgICBleHBlY3QodXRpbC5yb3dSYW5nZUZyb20gY29uZmxpY3Qub3Vycy5tYXJrZXIpLnRvRXF1YWwoWzUsIDZdKVxuXG4gICAgaXQgJ3JlY29nbml6ZXMgYmFubmVyIGxpbmVzIHdpdGggY29tbWl0IHNob3J0bG9nIG1lc3NhZ2VzJywgLT5cbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC50aGVpcnMucmVmQmFubmVyTWFya2VyKS50b0VxdWFsKFsyLCAzXSlcbiAgICAgIGV4cGVjdCh1dGlsLnJvd1JhbmdlRnJvbSBjb25mbGljdC5vdXJzLnJlZkJhbm5lck1hcmtlcikudG9FcXVhbChbNiwgN10pXG5cbiAgICBpdCAnbWFya3MgXCJ0aGVpcnNcIiBhcyB0aGUgdG9wIGFuZCBcIm91cnNcIiBhcyB0aGUgYm90dG9tJywgLT5cbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMucG9zaXRpb24pLnRvQmUoJ3RvcCcpXG4gICAgICBleHBlY3QoY29uZmxpY3Qub3Vycy5wb3NpdGlvbikudG9CZSgnYm90dG9tJylcblxuICAgIGl0ICdsaW5rcyBlYWNoIHNpZGUgdG8gdGhlIGZvbGxvd2luZyBtYXJrZXInLCAtPlxuICAgICAgZXhwZWN0KGNvbmZsaWN0LnRoZWlycy5mb2xsb3dpbmdNYXJrZXIpLnRvQmUoY29uZmxpY3QubmF2aWdhdG9yLnNlcGFyYXRvck1hcmtlcilcbiAgICAgIGV4cGVjdChjb25mbGljdC5vdXJzLmZvbGxvd2luZ01hcmtlcikudG9CZShjb25mbGljdC5vdXJzLnJlZkJhbm5lck1hcmtlcilcblxuICBkZXNjcmliZSAnc2lkZXMnLCAtPlxuICAgIFtlZGl0b3IsIGNvbmZsaWN0XSA9IFtdXG5cbiAgICBiZWZvcmVFYWNoIC0+XG4gICAgICB1dGlsLm9wZW5QYXRoICdzaW5nbGUtMndheS1kaWZmLnR4dCcsIChlZGl0b3JWaWV3KSAtPlxuICAgICAgICBlZGl0b3IgPSBlZGl0b3JWaWV3LmdldE1vZGVsKClcbiAgICAgICAgW2NvbmZsaWN0XSA9IENvbmZsaWN0LmFsbCB7fSwgZWRpdG9yXG5cbiAgICBpdCAncmV0YWlucyBhIHJlZmVyZW5jZSB0byBjb25mbGljdCcsIC0+XG4gICAgICBleHBlY3QoY29uZmxpY3Qub3Vycy5jb25mbGljdCkudG9CZShjb25mbGljdClcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMuY29uZmxpY3QpLnRvQmUoY29uZmxpY3QpXG5cbiAgICBpdCAncmVtZW1iZXJzIGl0cyBpbml0aWFsIHRleHQnLCAtPlxuICAgICAgZWRpdG9yLnNldEN1cnNvckJ1ZmZlclBvc2l0aW9uIFsxLCAwXVxuICAgICAgZWRpdG9yLmluc2VydFRleHQgXCJJIHByZWZlciB0aGlzIHRleHQhIFwiXG5cbiAgICAgIGV4cGVjdChjb25mbGljdC5vdXJzLm9yaWdpbmFsVGV4dCkudG9CZShcIlRoZXNlIGFyZSBteSBjaGFuZ2VzXFxuXCIpXG5cbiAgICBpdCAncmVzb2x2ZXMgYXMgXCJvdXJzXCInLCAtPlxuICAgICAgY29uZmxpY3Qub3Vycy5yZXNvbHZlKClcblxuICAgICAgZXhwZWN0KGNvbmZsaWN0LnJlc29sdXRpb24pLnRvQmUoY29uZmxpY3Qub3VycylcbiAgICAgIGV4cGVjdChjb25mbGljdC5vdXJzLndhc0Nob3NlbigpKS50b0JlKHRydWUpXG4gICAgICBleHBlY3QoY29uZmxpY3QudGhlaXJzLndhc0Nob3NlbigpKS50b0JlKGZhbHNlKVxuXG4gICAgaXQgJ3Jlc29sdmVzIGFzIFwidGhlaXJzXCInLCAtPlxuICAgICAgY29uZmxpY3QudGhlaXJzLnJlc29sdmUoKVxuXG4gICAgICBleHBlY3QoY29uZmxpY3QucmVzb2x1dGlvbikudG9CZShjb25mbGljdC50aGVpcnMpXG4gICAgICBleHBlY3QoY29uZmxpY3Qub3Vycy53YXNDaG9zZW4oKSkudG9CZShmYWxzZSlcbiAgICAgIGV4cGVjdChjb25mbGljdC50aGVpcnMud2FzQ2hvc2VuKCkpLnRvQmUodHJ1ZSlcblxuICAgIGl0ICdicm9hZGNhc3RzIGFuIGV2ZW50IG9uIHJlc29sdXRpb24nLCAtPlxuICAgICAgcmVzb2x2ZWQgPSBmYWxzZVxuICAgICAgY29uZmxpY3Qub25EaWRSZXNvbHZlQ29uZmxpY3QgLT4gcmVzb2x2ZWQgPSB0cnVlXG4gICAgICBjb25mbGljdC5vdXJzLnJlc29sdmUoKVxuICAgICAgZXhwZWN0KHJlc29sdmVkKS50b0JlKHRydWUpXG5cbiAgZGVzY3JpYmUgJ25hdmlnYXRvcicsIC0+XG4gICAgW2NvbmZsaWN0cywgbmF2aWdhdG9yXSA9IFtdXG5cbiAgICBiZWZvcmVFYWNoIC0+XG4gICAgICB1dGlsLm9wZW5QYXRoICd0cmlwbGUtMndheS1kaWZmLnR4dCcsIChlZGl0b3JWaWV3KSAtPlxuICAgICAgICBjb25mbGljdHMgPSBDb25mbGljdC5hbGwoe30sIGVkaXRvclZpZXcuZ2V0TW9kZWwoKSlcbiAgICAgICAgbmF2aWdhdG9yID0gY29uZmxpY3RzWzFdLm5hdmlnYXRvclxuXG4gICAgaXQgJ2tub3dzIGl0cyBjb25mbGljdCcsIC0+XG4gICAgICBleHBlY3QobmF2aWdhdG9yLmNvbmZsaWN0KS50b0JlKGNvbmZsaWN0c1sxXSlcblxuICAgIGl0ICdsaW5rcyB0byB0aGUgcHJldmlvdXMgY29uZmxpY3QnLCAtPlxuICAgICAgZXhwZWN0KG5hdmlnYXRvci5wcmV2aW91cykudG9CZShjb25mbGljdHNbMF0pXG5cbiAgICBpdCAnbGlua3MgdG8gdGhlIG5leHQgY29uZmxpY3QnLCAtPlxuICAgICAgZXhwZWN0KG5hdmlnYXRvci5uZXh0KS50b0JlKGNvbmZsaWN0c1syXSlcblxuICAgIGl0ICdza2lwcyByZXNvbHZlZCBjb25mbGljdHMnLCAtPlxuICAgICAgbmF2ID0gY29uZmxpY3RzWzBdLm5hdmlnYXRvclxuICAgICAgY29uZmxpY3RzWzFdLm91cnMucmVzb2x2ZSgpXG4gICAgICBleHBlY3QobmF2Lm5leHRVbnJlc29sdmVkKCkpLnRvQmUoY29uZmxpY3RzWzJdKVxuXG4gICAgaXQgJ3JldHVybnMgbnVsbCBhdCB0aGUgZW5kJywgLT5cbiAgICAgIG5hdiA9IGNvbmZsaWN0c1syXS5uYXZpZ2F0b3JcbiAgICAgIGV4cGVjdChuYXYubmV4dCkudG9CZU51bGwoKVxuICAgICAgZXhwZWN0KG5hdi5uZXh0VW5yZXNvbHZlZCgpKS50b0JlTnVsbCgpXG4iXX0=
